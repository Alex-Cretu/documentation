## AWS Networking

AWS virtual private cloud (VPC) provides a logical isolation for resources like EC2, ELB, EBS etc. from other VPCs. VPC uses Classless Inter-Domain Routing (CIDR) to specify the IP address range. This allows you to create sub networks in different availability zones via subnet with a subset of VPCs’ IP addresses using CIDR. The XL Deploy AWS Plugin helps you create VPC networking via the CI model. It contains CIs for each networking resource like VPC, Subnet, Route Table, Internet Gateway, VPC Peering etc.


## Networking Elements

**VPC:** VPC allows IPv4 address range via the CIDR and IPv6 addresses which are Amazon provided. VPC also controls the DNS support for the instances associated to it. It can be switched on or off through the VPC properties. If VPC is enabled, the instances will get hostnames for private and public ipv4 address. 

**Subnet:** The subnet within a VPC specifies sub network with a subset of VPC’s IP addresses. It is associated with an availability zone in the given region. A subnet can be made public using Internet Gateway and Route Table.

**Security Group:** Security Group helps define network traffic rules between two IPs or CIDRs or Security Groups. A rule can be inbound or outbound with given protocol and port or port range.

**Internet Gateway:** Internet Gateway allows instances to access the internet. A route rule is required in order to enable the internet gateway connectivity.

**VPC Peering:** VPC peering connection allows traffic flow across VPCs.

**Network Interface:** Network Interface allows network management for EC2 instances for scenarios like security, low budget high availability solutions.

**Route Table:** A route table allows you to define rules for traffic redirection between source and destination.


## Networking Special Cases
### IPv6 CIDR support for subnets with amazon provided IPv6 CIDR. 
   * IPv4 CIDR is auto generated by amazon and assigned to VPC
   * If the subnet is created in a package where the VPC is also a part of it, the user must provide only the CIDR suffix and XL Deploy uses VPC IPv6 CIDR to construct subnet IPv6 CIDR.

### Auto Scaling Group with plugin managed launch configuration. 
   * Launch configuration is an AWS resource that describes the EC2 instance template.
   * XL Deploy does not support separate CI for it and it is part of the Auto Scaling Group CI.
   * The launchConfigurationInstanceId property is used to specify the EC2 instance template, using XL Deploy which creates the Launch configuration with auto generated configuration name.
   * If this property is changed in the update package, XL Deploy deletes the previous launch configuration and creates a new launch configuration.

### Dummy listener in ELB to change complete set of listeners. 
  * Class load balancer requires minimum one listener associated to it. As a result, XL Deploy has to attach a dummy listener running over port 65535 while add/remove listener for complete listeners set the change in the update package.

### Deletion of auto created Network Interface while detaching subnets from ELB/ALB	
   * AWS load balancer ELB/ALB creates a Network Interface for one of the subnets associated to it. AWS does not handle the reverse action (for examples: deletion of auto created Network Interface when given subnet is being dissociated from ELB/ALB). XL Deploy deletes this Network Interface associated with the given subnet in this case. This is how the subnets update is successfull.
